@model Artisans.Models.ArtisanDashboardViewModel 
@{
    ViewData["Title"] = Model.ArtisanProfile?.BrandName + " - Storefront";
}

@if (Model.ArtisanProfile == null)
{
    <div class="container text-center py-5">
        <h1 class="page-header-title">Artisan Not Found</h1>
        <p class="page-header-subtitle">Sorry, the artisan you are looking for could not be found or their profile is not approved.</p>
        <a asp-action="Products" asp-controller="Browse" class="btn btn-primary mt-3">Browse All Products</a>
    </div>
    return;
}

<!-- Artisan Header -->
<div class="container-fluid page-header-container">
    <div class="container text-center">
        @if(!string.IsNullOrEmpty(Model.ArtisanProfile.ProfilePictureUrl))
        {
            <img src="@Model.ArtisanProfile.ProfilePictureUrl" alt="@Model.ArtisanProfile.BrandName" class="artisan-profile-pic mb-3" />
        }
        else
        {
            <img src="/images/artisans/placeholder.svg" alt="@Model.ArtisanProfile.BrandName" class="artisan-profile-pic mb-3" />
        }
        <h1 class="page-header-title">@Model.ArtisanProfile.BrandName</h1>
        @if(!string.IsNullOrEmpty(Model.ArtisanProfile.Bio))
        {
            <p class="page-header-subtitle">@Html.Raw(Model.ArtisanProfile.Bio.Replace("\n", "<br />"))</p>
        }
    </div>
</div>

<div class="container mt-5">
    <!-- Products Section -->
    <h2 class="section-title-underline">Products from @Model.ArtisanProfile.BrandName</h2>
    @if (!Model.Products.Any())
    {
        <p class="text-center my-5 text-muted">This artisan has not listed any products yet.</p>
    }
    else
    {
        <div class="product-grid mb-5">
            @foreach (var item in Model.Products)
            {
                <div class="product-card fade-in-up">
                    <a asp-controller="Browse" asp-action="ProductDetails" asp-route-id="@item.Id" class="product-card-link">
                        <img src="@(!string.IsNullOrEmpty(item.MainImageUrl) ? item.MainImageUrl : "/images/products/placeholder.jpg")"
                             alt="@item.Name"
                             class="product-image">
                        <div class="product-info">
                            <h3 class="product-title">@item.Name</h3>
                            @if(item.Category != null)
                            {
                                <span class="badge bg-secondary mb-2">@item.Category.Name</span>
                            }
                            <div class="product-price">@item.Price.ToString("C")</div>
                        </div>
                    </a>
                    <div class="product-card-footer">
                        <a asp-controller="Browse" asp-action="ProductDetails" asp-route-id="@item.Id" class="btn btn-view-product">View Details</a>
                    </div>
                </div>
            }
        </div>
    }

    <!-- Materials Section -->
    <h2 class="section-title-underline">Materials from @Model.ArtisanProfile.BrandName</h2>
    @if (!Model.Materials.Any())
    {
        <p class="text-center my-5 text-muted">This artisan has not listed any materials yet.</p>
    }
    else
    {
         <div class="product-grid">
            @foreach (var item in Model.Materials)
            {
                <div class="product-card fade-in-up">
                    <a asp-controller="Browse" asp-action="MaterialDetails" asp-route-id="@item.Id" class="product-card-link">
                        <img src="@(!string.IsNullOrEmpty(item.ImageUrl) ? item.ImageUrl : "/images/materials/placeholder.svg")"
                             alt="@item.Name"
                             class="product-image">
                        <div class="product-info">
                            <h3 class="product-title">@item.Name</h3>
                             @if(item.Category != null)
                            {
                                <span class="badge bg-secondary mb-2">@item.Category.Name</span>
                            }
                            <div class="product-price">@item.PricePerUnit.ToString("C") / @item.UnitOfMeasure</div>
                        </div>
                    </a>
                    <div class="product-card-footer">
                        <a asp-controller="Browse" asp-action="MaterialDetails" asp-route-id="@item.Id" class="btn btn-view-product">View Details</a>
                    </div>
                </div>
            }
        </div>
    }
</div>
